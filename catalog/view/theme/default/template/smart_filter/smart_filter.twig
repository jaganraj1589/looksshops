<div class="accordion border" id="accordionExample">
  {% if pricr_filter_status==1 %}
  <div class="card">
    <div class=" card-head" id="headingOne">
      <h2 class="text h2" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
          {{text_price}}
      </h2>
    </div>

    <div id="collapseOne" class="collapse in" aria-labelledby="headingOne" data-parent="#accordionExample">
      <div class="card-body">
     <div class="range-slider"><span>from
    <input type="number" value="{{prices.min_price}}" min="{{prices.min_price}}" max="{{prices.max_price}}"/> to
    
    <input type="number" value="{{prices.max_price}}" min="{{prices.min_price}}" max="{{prices.max_price}}"/></span>
  <input value="{{prices.min_price}}" name="price_min" min="{{prices.min_price}}" max="{{prices.max_price}}" step="10" type="range"/ id="min_price">
  <input value="{{prices.max_price}}" name="price_max"  min="{{prices.min_price}}" max="{{prices.max_price}}" step="10" type="range"/ id="max_price">
  <svg width="100%" height="24">
    <line x1="4" y1="0" x2="300" y2="0" stroke="#444" stroke-width="12" stroke-dasharray="1 28"></line>
  </svg>
</div>
      </div>
    </div>
  </div>
  {% endif %}
  {% if category_filter_status==1 %}
  {% if categories %}
  <div class="card">
    <div class=" card-head" id="cat_row_{{categories.category_id}}">
      <h2 class="text h2" data-toggle="collapse" data-target="#col_{{categories.category_id}}" aria-expanded="true" aria-controls="col_{{categories.category_id}}">
          {{text_categories}}
      </h2>
    </div>
   
    <div id="col_{{categories.category_id}}" class="collapse in" aria-labelledby="cat_row_{{categories.category_id}}" data-parent="#cat_row_{{categories.category_id}}">
      <div class="card-body">
   <!--  <input type="checkbox" id="cat_{{category_id}}" name="category" value="{{category_id}}" checked="checked" style="display:none;"> -->
{% if categories %}
{% for category in categories %}

<ul id="category-tabs">
    <li class="main-category">
      <input type="checkbox" id="cat_{{category.category_id}}" name="category" value="{{category.category_id}}">
      <label for="cat_{{category.category_id}}">
        <a href="javascript:void(0)" class="main-category" data-id='{{category.category_id}}'>{{category.name}}<i class="fa fa-plus"></i>
        </a>
      </label>
        <ul class="sub-category-tabs" style="display: none;">
           {% if category.children %}
          {% for children in category.children %}
            <li><input type="checkbox" name="category"  id="cat_{{children.category_id}}"  value="{{children.category_id}}"><label for="cat_{{children.category_id}}">{{children.name}}</label></li>
            {% endfor %}
            {% endif %}
        </ul>
    </li>
</ul>
{% endfor %}
{% endif %}
      </div>
    </div>
   
  </div>
  {% endif %}
  {% endif %}

  
  {% if manufacturer_filter_status==1 %}
  {% if manufacturers is not null and manufacturers is not empty %}
   <div class="card">
    <div class=" card-head" id="manu_row_{{manufacturers.manufacturer_id}}">
      <h2 class="text h2" data-toggle="collapse" data-target="#coll_{{manufacturers.manufacturer_id}}" aria-expanded="true" aria-controls="coll_{{manufacturers.manufacturer_id}}">
          {{text_manufrecturer}}
      </h2>
    </div>

    <div id="coll_{{manufacturers.manufacturer_id}}" class="collapse in" aria-labelledby="manu_row_{{manufacturers.manufacturer_id}}" data-parent="#manu_row_{{manufacturers.manufacturer_id}}">

      <div class="card-body">

<ul class="list-group">
          
          {% if manufacturers is not null and manufacturers is not empty %}
        {% for manufacturer in manufacturers %}
  <li class="list-group-item ">
     <input name="manufacture" type="checkbox" id="manu_{{manufacturer.manufacturer_id}}" value="{{manufacturer.manufacturer_id}}">
        <label for="manu_{{manufacturer.manufacturer_id}}">
                           {% if manufacturer.image %} <img src ="{{manufacturer.image}}" width="25px" height="25px">{%endif%}{{manufacturer.name}}
                </label>
              </li>
              {% endfor %}
{% endif %}
</ul>
      </div>
    </div>
  </div>
  {% endif %}
  {% endif %}
  
  {% if optin_status==1 %}

  {% if options %}
  {% for option in options%}
   <div class="card">
    <div class=" card-head" id="option_row_{{option.option_id}}">
      <h2 class="text h2" data-toggle="collapse" data-target="#colleps_row_{{option.option_id}}" aria-expanded="true" aria-controls="colleps_row_data-page{{option.option_id}}">
          {{option.name}}
      </h2>
    </div>

    <div id="colleps_row_{{option.option_id}}" class="collapse in" aria-labelledby="option_row_{{option.option_id}}" data-parent="#option_row_{{option.option_id}}">

      <div class="card-body">

<ul class="list-group">
          {% if option.option_values is not null and option.option_values is not empty %}
        {% for op_value in option.option_values %}
  <li class="list-group-item ">
     <input name="options" type="checkbox" value="{{op_value.option_value_id}}" id="option_{{op_value.option_value_id}}" >
        <label for="option_{{op_value.option_value_id}}" >
                            {% if op_value.image %}<img src ="{{img_url}}{{op_value.image}}" width="25px" height="25px">{%endif%}{{op_value.name}}
                </label>
              </li>
              {% endfor %}
{% endif %}
</ul>
      </div>
    </div>
  </div>
  {%endfor%}
  {%endif%}
  {%endif%}
  {% if attribute_status==1 %}
{% if attributes %}
{% for attribute in attributes %}
  <div class="card">
    <div class=" card-head" id="attribute_row_{{attribute.attribute_group_id}}">
      <h2 class="text h2" data-toggle="collapse" data-target="#colleps_row_{{attribute.attribute_group_id}}" aria-expanded="true" aria-controls="colleps_row_{{attribute.attribute_group_id}}">
          {{attribute.name}}
      </h2>
    </div>

    <div id="colleps_row_{{attribute.attribute_group_id}}" class="collapse in" aria-labelledby="attribute_row_{{attribute.attribute_group_id}}" data-parent="#attribute_row_{{attribute.attribute_group_id}}">

      <div class="card-body">
       {% for attr in attribute.attribute_value %}
<ul class="list-group">      
  <li class="list-group-item ">
     <input name="attribute" type="checkbox" value="{{attr.attribute_id}}" id="attr_{{attr.attribute_id}}">
        <label for="attr_{{attr.attribute_id}}">{{attr.text}}</label>
              </li>
             
</ul>
{% endfor %}
 
      </div>
    </div>
   
  </div>
  {% endfor %}
{% endif %}
{% endif %}

 
</div>

<script type="text/javascript">
  $(document).ready(function(){

  // Product Grid
  
$(document).on('click','#list-view',function() {

    $('#content .product-grid > .clearfix').remove();

    $('#content .row > .product-grid').attr('class', 'product-layout product-list col-xs-12');
    $('#grid-view').removeClass('active');
    $('#list-view').addClass('active');

    localStorage.setItem('display', 'list');
  });

  $(document).on('click','#grid-view',function() {
    var cols = $('#column-right, #column-left').length;

    if (cols == 2) {
      $('#content .product-list').attr('class', 'product-layout product-grid col-lg-6 col-md-6 col-sm-12 col-xs-12');
    } else if (cols == 1) {
      $('#content .product-list').attr('class', 'product-layout product-grid col-lg-4 col-md-4 col-sm-6 col-xs-12');
    } else {
      $('#content .product-list').attr('class', 'product-layout product-grid col-lg-3 col-md-3 col-sm-6 col-xs-12');
    }

    $('#list-view').removeClass('active');
    $('#grid-view').addClass('active');

    localStorage.setItem('display', 'grid');
  });
});

  var path='&path={{category_id}}';

 $(document).ready(function(){

  var checked = [];
    $(document).on('click','.pagination li a',function(e){
      e.preventDefault();

      $('.pagination li a').removeClass('active');
      $(this).addClass('active');
      
      var pagenumber=$(this).attr('data-page');
      
      var names = [];
        // page
        
        if(names.indexOf('page') == -1) {
          names.push('page');
        }

      //page

         if(names.indexOf('sort') == -1) {
            names.push('sort');
            } 
            if(names.indexOf('limit') == -1) {
            names.push('limit');
            }

        $.each($('input[type="checkbox"]:checked'), function(){

          if(names.indexOf($(this).attr('name')) == -1) {
            names.push($(this).attr('name'));
          }
        });

        if(names.indexOf($('#min_price').attr('name')) == -1) {
            names.push($('#min_price').attr('name'));
          }

        if(names.indexOf($('#max_price').attr('name')) == -1) {
            names.push($('#max_price').attr('name'));
         }

        $.each(names, function(k, v){
          var items = [];  
          $('input[name="'+v+'"]:checked').each(function(){
            items.push($(this).val());
          });

          checked[k] = {
            name : v,
            items : items
          };
          
          if(v=='price_min'){ 
            checked[k] = {
              name : v,
              items : $('#min_price').val()
            }; 
          }
          
          if(v=='price_max'){ 
          checked[k] = {
            name : v,
            items : $('#max_price').val()
          }; 
        }
      if(v=='sort'){ 
            checked[k] = {
              name : v,
              items : $('#input-sort').val()
            }; 
          } 

          if(v=='limit'){ 
            checked[k] = {
              name : v,
              items : $('#input-limit').val()
            }; 
          }

        if(v=='page'){ 
          checked[k] = {
            name : v,
            items : pagenumber
          }; 
        }


      });

      jQuery.ajax({
        url: 'index.php?route=smart_filter/smart_filter/filter_category'+path,
        type :"POST",
        dataType: 'JSON',
        data: {
          filter:JSON.stringify(checked),
          request:'{{request}}'
        },
        cache: false,
        success: function(data){
        $('#content').html(data);
        if (localStorage.getItem('display') == 'list') {

          $('#content .product-grid > .clearfix').remove();

          $('#content .row > .product-grid').attr('class', 'product-layout product-list col-xs-12');
          $('#grid-view').removeClass('active');
          $('#list-view').addClass('active');

          localStorage.setItem('display', 'list');
      } else {

        var cols = $('#column-right, #column-left').length;

        if (cols == 2) {
          $('#content .product-list').attr('class', 'product-layout product-grid col-lg-6 col-md-6 col-sm-12 col-xs-12');
        } else if (cols == 1) {
          $('#content .product-list').attr('class', 'product-layout product-grid col-lg-4 col-md-4 col-sm-6 col-xs-12');
        } else {
          $('#content .product-list').attr('class', 'product-layout product-grid col-lg-3 col-md-3 col-sm-6 col-xs-12');
        }

        $('#list-view').removeClass('active');
        $('#grid-view').addClass('active');

        localStorage.setItem('display', 'grid');
      }

      },
      
    });


    });
      



    $(document).on('change','input[type="checkbox"],#min_price,#max_price,#input-sort,#input-limit',function(){
      //alert('aaa');

          var pagenumber=$('.pagination li.active span').text();
          var names = [];
          
          
            // page
            
          if(names.indexOf('page') == -1) {
            names.push('page');
          }
          if(names.indexOf('sort') == -1) {
            names.push('sort');
            } 
            if(names.indexOf('limit') == -1) {
            names.push('limit');
            }

         

          $.each($('input[type="checkbox"]:checked'), function(){

            if(names.indexOf($(this).attr('name')) == -1) {
              names.push($(this).attr('name'));
            }
          });
          
         
          if(names.indexOf($('#min_price').attr('name')) == -1) {
              names.push($('#min_price').attr('name'));
            }
           

          if(names.indexOf($('#min_price').attr('name')) == -1) {
              names.push($('#min_price').attr('name'));
          }
           
            
         

        $.each(names, function(k, v){

          var items = []; 

          $('input[name="'+v+'"]:checked').each(function(){
            items.push($(this).val());
          }); 


          checked[k] = {
            name : v,
            items : items
          };

          if(v=='price_min'){ 
            checked[k] = {
              name : v,
              items : $('#min_price').val()
            }; 
          }

          if(v=='price_max'){ 
            checked[k] = {
              name : v,
              items : $('#max_price').val()
            }; 
          } 
          if($('#input-sort').val()){
               if(v=='sort'){ 
            checked[k] = {
              name : v,
              items : $('#input-sort').val()
            }; 
          } 
          }
         
         if($('#input-limit').val()){
            if(v=='limit'){ 
            checked[k] = {
              name : v,
              items : $('#input-limit').val()
            }; 
          }
         }
          



        if(v=='page'){ 
          checked[k] = {
            name : v,
            items : pagenumber
          }; 
        }
       
        });

      jQuery.ajax({
        url: 'index.php?route=smart_filter/smart_filter/filter_category'+path,
        type :"POST",
        dataType: 'JSON',
        data: {
          filter:JSON.stringify(checked),
          request:'{{request}}'
        },
        cache: false,
        success: function(data){
          $('#content').html(data);
          if (localStorage.getItem('display') == 'list') {
          
            $('#content .product-grid > .clearfix').remove();

            $('#content .row > .product-grid').attr('class', 'product-layout product-list col-xs-12');
            $('#grid-view').removeClass('active');
            $('#list-view').addClass('active');

            localStorage.setItem('display', 'list');
          } else {
            var cols = $('#column-right, #column-left').length;

            if (cols == 2) {
              $('#content .product-list').attr('class', 'product-layout product-grid col-lg-6 col-md-6 col-sm-12 col-xs-12');
            } else if (cols == 1) {
              $('#content .product-list').attr('class', 'product-layout product-grid col-lg-4 col-md-4 col-sm-6 col-xs-12');
            } else {
              $('#content .product-list').attr('class', 'product-layout product-grid col-lg-3 col-md-3 col-sm-6 col-xs-12');
            }

            $('#list-view').removeClass('active');
            $('#grid-view').addClass('active');

            localStorage.setItem('display', 'grid');
      }

    },
      
    });
        });
    });

</script>